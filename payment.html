<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Ödeme Sonucu</title>
</head>
<body>
  <h1 id="result">Ödeme kontrol ediliyor...</h1>
  <script>
    const params = new URLSearchParams(window.location.search);
    const status = params.get("status");
    const sessionId = params.get("session_id");

    if (status === "paid" && sessionId) {
      // Firebase initialize et, sonra:
      fetch('https://your-cloud-function-url/verifyStripePayment', {
        method: 'POST',
        body: JSON.stringify({ data: { sessionId } }),
        headers: { 'Content-Type': 'application/json' }
      })
        .then(res => res.json())
        .then(result => {
          if (result.data?.success) {
            document.getElementById("result").innerText = `Ödeme başarıyla gerçekleşti. Yüklenen kredi: ${result.data.amount}`;
          } else {
            document.getElementById("result").innerText = "Ödeme tamamlanmadı.";
          }
        })
        .catch(() => {
          document.getElementById("result").innerText = "Doğrulama sırasında hata oluştu.";
        });
    } else {
      document.getElementById("result").innerText = "Ödeme yapılmadı veya eksik bilgi.";
    }
  </script>
</body>
</html>
